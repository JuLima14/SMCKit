<!DOCTYPE html>
<html lang="en">
  <head>
    <title>SMCKit  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script type="text/javascript">
    window.jazzy = {'docset': false}
    if (typeof window.dash != 'undefined') {
      document.documentElement.className += ' dash'
      window.jazzy.docset = true
    }
    if (navigator.userAgent.match(/xcode/i)) {
      document.documentElement.className += ' xcode'
      window.jazzy.docset = true
    }
    </script>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
  </head>
  <body id="reference" class="Swift">
    <a title="SMCKit  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p class="header-text"><a href="index.html">SMCKit Docs</a> (98% documented)</p>
        <p id="header-links"><a href="http://github.com/beltex/SMCKit"><img id="header-icon" src="img/gh.png" height="16px" width="16px" />View on GitHub</a></p>
      </div>
    </header>
    <section id="valence">
      <div class="content-wrapper">
        <p id="hierarchial_navigation">
        <a href="index.html" id="design_resources_link">SMCKit Reference</a>
        <img id="carat" src="img/carat.png" height="10px" width="6px" />
        SMCKit  Reference
        </p>
      </div>
    </section>
    <div class="content-wrapper">
      <nav class="book-parts">
        <ul class="nav-parts">
          <li class="part-name tasks">
          <a href="Global Variables.html">Global Variables</a>
            <ul class="nav-chapters">
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnAbortedVSs5Int32">kIOReturnAborted</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnBadArgumentVSs5Int32">kIOReturnBadArgument</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnBadMediaVSs5Int32">kIOReturnBadMedia</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit21kIOReturnBadMessageIDVSs5Int32">kIOReturnBadMessageID</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit13kIOReturnBusyVSs5Int32">kIOReturnBusy</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit19kIOReturnCannotLockVSs5Int32">kIOReturnCannotLock</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit19kIOReturnCannotWireVSs5Int32">kIOReturnCannotWire</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnDMAErrorVSs5Int32">kIOReturnDMAError</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnDeviceErrorVSs5Int32">kIOReturnDeviceError</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit14kIOReturnErrorVSs5Int32">kIOReturnError</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit24kIOReturnExclusiveAccessVSs5Int32">kIOReturnExclusiveAccess</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnIOErrorVSs5Int32">kIOReturnIOError</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnIPCErrorVSs5Int32">kIOReturnIPCError</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit22kIOReturnInternalErrorVSs5Int32">kIOReturnInternalError</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnInvalidVSs5Int32">kIOReturnInvalid</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit18kIOReturnIsoTooNewVSs5Int32">kIOReturnIsoTooNew</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit18kIOReturnIsoTooOldVSs5Int32">kIOReturnIsoTooOld</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit19kIOReturnLockedReadVSs5Int32">kIOReturnLockedRead</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit24kIOReturnMessageTooLargeVSs5Int32">kIOReturnMessageTooLarge</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnNoBandwidthVSs5Int32">kIOReturnNoBandwidth</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit19kIOReturnNoChannelsVSs5Int32">kIOReturnNoChannels</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit21kIOReturnNoCompletionVSs5Int32">kIOReturnNoCompletion</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnNoDeviceVSs5Int32">kIOReturnNoDevice</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnNoFramesVSs5Int32">kIOReturnNoFrames</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnNoInterruptVSs5Int32">kIOReturnNoInterrupt</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnNoMediaVSs5Int32">kIOReturnNoMedia</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnNoMemoryVSs5Int32">kIOReturnNoMemory</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnNoPowerVSs5Int32">kIOReturnNoPower</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnNoResourcesVSs5Int32">kIOReturnNoResources</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnNoSpaceVSs5Int32">kIOReturnNoSpace</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit19kIOReturnNotAlignedVSs5Int32">kIOReturnNotAligned</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnNotAttachedVSs5Int32">kIOReturnNotAttached</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnNotFoundVSs5Int32">kIOReturnNotFound</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnNotOpenVSs5Int32">kIOReturnNotOpen</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit21kIOReturnNotPermittedVSs5Int32">kIOReturnNotPermitted</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit22kIOReturnNotPrivilegedVSs5Int32">kIOReturnNotPrivileged</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnNotReadableVSs5Int32">kIOReturnNotReadable</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnNotReadyVSs5Int32">kIOReturnNotReady</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit22kIOReturnNotRespondingVSs5Int32">kIOReturnNotResponding</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnNotWritableVSs5Int32">kIOReturnNotWritable</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnOfflineVSs5Int32">kIOReturnOffline</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnOverrunVSs5Int32">kIOReturnOverrun</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit19kIOReturnPortExistsVSs5Int32">kIOReturnPortExists</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnRLDErrorVSs5Int32">kIOReturnRLDError</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit18kIOReturnStillOpenVSs5Int32">kIOReturnStillOpen</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnTimeoutVSs5Int32">kIOReturnTimeout</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit17kIOReturnUnderrunVSs5Int32">kIOReturnUnderrun</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit25kIOReturnUnformattedMediaVSs5Int32">kIOReturnUnformattedMedia</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit20kIOReturnUnsupportedVSs5Int32">kIOReturnUnsupported</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit24kIOReturnUnsupportedModeVSs5Int32">kIOReturnUnsupportedMode</a>
              </li>
              <li class="nav-chapter">
                <a href="Global Variables.html#/s:v6SMCKit16kIOReturnVMErrorVSs5Int32">kIOReturnVMError</a>
              </li>
            </ul>
          </li>
          <li class="part-name tasks">
          <a href="Structs.html">Structs</a>
            <ul class="nav-chapters">
              <li class="nav-chapter">
                <a href="Structs/SMC.html">SMC</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <div class="pixel-line"></div>
      <div class="rubber-band-gap"></div>
      <article class="chapter">
      <a name="/"></a>
        <h1 class="chapter-name">SMCKit</h1>
        <section>
          <section class="section">
            <div class='readme'><a href='#smckit' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='smckit'>SMCKit</h1>
<p class="para">A System Management Controller (SMC) library in pure Swift from user space for
Intel based Macs. The library works by talking to the AppleSMC.kext (kernel
extension), the closed source driver for the SMC. Read temperature sensors,
get and set fan speed (RPM), and more.</p>
<ul>
<li>For a C based version, see <a href="https://github.com/beltex/libsmc">libsmc</a></li>
<li>For other system related statistics in Swift for OS X, see
<a href="https://github.com/beltex/SystemKit">SystemKit</a></li>
</ul>
<a href='#system_management_controller' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='system_management_controller'>System Management Controller</h3>
<p class="para"><em><q>The System Management Controller (SMC) is an internal subsystem introduced by
Apple Inc. with the introduction of their new Intel processor based machines
in 2006. It takes over the functions of the SMU. The SMC manages thermal and
power conditions to optimize the power and airflow while keeping audible noise
to a minimum. Power consumption and temperature are monitored by the operating
system, which communicates the necessary adjustments back to the SMC. The SMC
makes the changes, slowing down or speeding up fans as necessary.</q></em>
-via Wikipedia</p><p class="para">For more see:</p>
<ul>
<li><a href="http://en.wikipedia.org/wiki/System_Management_Controller">System Management Controller</a></li>
<li><a href="http://en.wikipedia.org/wiki/System_Management_Unit">System Management Unit</a></li>
<li><a href="http://en.wikipedia.org/wiki/Power_Management_Unit">Power Management Unit</a></li>
</ul>
<a href='#requirements' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='requirements'>Requirements</h3>

<ul>
<li><a href="https://developer.apple.com/xcode/downloads/">Xcode 6.1</a></li>
<li>OS X 10.9+

<ul>
<li>This is due to Swift</li>
</ul></li>
</ul>
<a href='#installation' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='installation'>Installation</h3>
<p class="para">The quick and easy solution is to simply copy the <code>SMC.swift</code> file into your
project. For a more proper longer term solution, see below via
<a href="https://github.com/Alamofire/Alamofire">Alamofire</a>.</p><p class="para"><em>Due to the current lack of <a href="http://cocoapods.org">proper infrastructure</a> for
Swift dependency management, using SMCKit in your project requires the following
steps:</em></p>
<ol>
<li>Add SMCKit as a <a href="http://git-scm.com/docs/git-submodule">submodule</a> by opening
the Terminal, <code>cd</code>-ing into your top-level project directory, and entering
the command <code>git submodule add https://github.com/beltex/SMCKit.git</code></li>
<li>Open the <code>SMCKit</code> folder, and drag <code>SMCKit.xcodeproj</code> into the file navigator
of your project.</li>
<li>In Xcode, navigate to the target configuration window by clicking on the blue
project icon, and selecting the application target under the <q>Targets</q>
heading in the sidebar.</li>
<li>Ensure that the deployment target of SMCKit.framework matches that of the
application target.</li>
<li>In the tab bar at the top of that window, open the <q>Build Phases</q> panel.</li>
<li>Expand the <q>Target Dependencies</q> group, and add <code>SMCKit.framework</code>.</li>
<li>Click on the <code>+</code> button at the top left of the panel and select <q>New Copy
Files Phase</q>. Rename this new phase to <q>Copy Frameworks</q>, set the
<q>Destination</q> to <q>Frameworks</q>, and add <code>SMCKit.framework</code>.</li>
</ol>
<p class="para"><strong>NOTE</strong>: If you are building an OS X command line tool, the above won&rsquo;t quite
          work. See here for
          <a href="https://github.com/ksm/SwiftInFlux#runtime-dynamic-libraries">why</a>.
          Instead of the last two steps, do the following:</p>
<blockquote>
<p class="para">Expand the <q>Compile Sources</q> group, and add <code>SMC.swift</code>.</p></blockquote>
<p class="para">In additon, you will have to turn on debug logging manually. This can be done by
adding <code>-D DEBUG</code> to the <strong>Other Swift Flags</strong> setting in your
<strong>Build Settings</strong>.</p><a href='#usage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='usage'>Usage</h3>
<pre class="highlight swift"><code><span class="c1">// If your not using SMCKit as a framework in your project, you should instead
// import IOKit
</span><span class="kd">import</span> <span class="kt">SMCKit</span>

<span class="k">var</span> <span class="nv">smc</span> <span class="o">=</span> <span class="kt">SMC</span><span class="p">()</span>

<span class="k">if</span> <span class="n">smc</span><span class="o">.</span><span class="nf">open</span><span class="p">()</span> <span class="o">==</span> <span class="n">kIOReturnSuccess</span> <span class="p">{</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"CPU 0 Diode Temperature: </span><span class="se">\(</span><span class="n">smc</span><span class="o">.</span><span class="nf">getTemperature</span><span class="p">(</span><span class="kt">SMC</span><span class="o">.</span><span class="kt">Temperature</span><span class="o">.</span><span class="kt">CPU_0_DIODE</span><span class="p">)</span><span class="o">.</span><span class="n">tmp</span><span class="se">)</span><span class="s">°C"</span><span class="p">)</span>
    <span class="nf">println</span><span class="p">(</span><span class="s">"Fan 0 Speed: </span><span class="se">\(</span><span class="n">smc</span><span class="o">.</span><span class="nf">getFanRPM</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">rpm</span><span class="se">)</span><span class="s"> RPM"</span><span class="p">)</span>
    <span class="n">smc</span><span class="o">.</span><span class="nf">close</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>
<p class="para">A more detailed example can be seen
<a href="https://github.com/beltex/SMCKit/blob/master/Example/main.swift">here</a>. The
following is sample output from it:</p><pre class="highlight plaintext"><code>// MACHINE STATUS

-- TEMPERATURE --
CPU_0_DIODE
  70.0°C
CPU_0_PROXIMITY
  58.0°C
ENCLOSURE_BASE_0
  35.0°C
ENCLOSURE_BASE_1
  35.0°C
ENCLOSURE_BASE_2
  34.0°C
ENCLOSURE_BASE_3
  38.0°C
HEATSINK_1
  58.0°C
NORTHBRIDGE_DIODE
  65.0°C
NORTHBRIDGE_PROXIMITY
  53.0°C
PALM_REST
  34.0°C

-- FAN --
Exhaust
  1998 RPM

-- BATTERY &amp; POWER --
AC Present:          true
Battery Powered:     false
Charging:            false
Battery Ok:          true
Max # of Batteries:  1

-- MISC --
Disc in ODD:         false
</code></pre>
<p class="para">The use of this framework will almost certainly not be allowed in the Mac App
Store as it is essentially using a private API. Also, keep in mind that Swift
currently offers no
<a href="https://github.com/ksm/SwiftInFlux#abi-stability">ABI stability</a>.</p><a href='#references' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='references'>References</h3>
<p class="para">There are many projects that interface with the SMC for one purpose or another. Credit is most
certainly due to them for the reference code. Such projects as:</p>
<ul>
<li>iStat Pro</li>
<li><a href="https://github.com/lavoiesl/osx-cpu-temp">osx-cpu-temp</a></li>
<li><a href="http://www.opensource.apple.com/source/PowerManagement/">PowerManagement</a></li>
<li><a href="https://github.com/hholtmann/smcFanControl">smcFanControl</a></li>
</ul>
<p class="para">Handy I/O Kit references:</p>
<ul>
<li><a href="http://ca.wiley.com/WileyCDA/WileyTitle/productCd-1118204123.html">iOS Hacker&rsquo;s Handbook</a></li>
<li><a href="http://ca.wiley.com/WileyCDA/WileyTitle/productCd-1118057651.html">Mac OS X and iOS Internals: To the Apple&rsquo;s Core</a></li>
<li><a href="http://www.apress.com/9781430235361-4892">OS X and iOS Kernel Programming</a></li>
</ul>
<a href='#license' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='license'>License</h3>
<p class="para">This project is under the <strong>MIT License</strong>.</p><a href='#fun' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='fun'>Fun</h3>
<p class="para">While the SMC driver is closed source, the call strucutre and definition of
certain structs needed to interact with it (see <code>SMCParamStruct</code>) happened to
appear in the open source Apple <strong>PowerManagement</strong> project at around version
211, and soon after disappeared. They can be seen in the
<a href="http://www.opensource.apple.com/source/PowerManagement/PowerManagement-211/pmconfigd/PrivateLib.c">PrivateLib.c</a>
file under <code>pmconfigd</code>. In the very same source file, the following snippet can be
found:</p><pre class="highlight c"><code><span class="c1">// And simply AppleSMC with kCFBooleanTrue to let them know time is changed.
// We don't pass any information down.
</span><span class="n">IORegistryEntrySetCFProperty</span><span class="p">(</span> <span class="n">_smc</span><span class="p">,</span>
                    <span class="n">CFSTR</span><span class="p">(</span><span class="s">"TheTimesAreAChangin"</span><span class="p">),</span>
                    <span class="n">kCFBooleanTrue</span><span class="p">);</span>
</code></pre>
<p class="para">Almost certainly a reference to Bob Dylan&rsquo;s
<a href="https://en.wikipedia.org/wiki/The_Times_They_Are_a-Changin%27_(song)">The Times They Are a-Changin&rsquo;</a>
. <a href="http://hypem.com/track/5zf9/Bob+Dylan+-+The+Times+They+Are+A-Changin&#x27;">Enjoy</a> :)</p></div>
          </section>
        </section>
        <section id="footer">
          <p class="copyright">&copy; 2015 <a class="link" href="https://github.com/beltex/" target="_blank" rel="external">beltex</a>. All rights reserved. (Last updated: 2015-01-12)</p>
          <p class="copyright">Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.0.20</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
